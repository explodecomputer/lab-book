{
  "hash": "03ea94be165064d873ed08fc1ef23af8",
  "result": {
    "markdown": "---\ntitle: \"Type 2 diabetes risk differences between populations\"\nauthor: Gibran Hemani\ndate: \"2023-11-21\"\ncategories: []\n---\n\n\n## Background\n\nT2D rates are ~5x higher amongst South Asians than native British populations in Britain. Most likely due to environmental differences, but could it hypothetically be explained by differences in genetic architecture?\n\nAssume polygenic common variant distribution and a disease liability threshold model.\n\n## Descriptive statistice\n\n- t2d diagnosis normally 45-65\n- people aged 45+ constitute approx 50% of 70 million people\n- therefore 4.9 million t2d cases in uk out of 35 million people who are susceptible\n- 3.07 million South Asians, assume 50% aged 45+\n- Prevalence is 5x higher amongst South Asians\n\nSimultaneous equations:\n\n$$\n4.9 = 1.54 x + 35y\n$$\n\nwhere $x$ is the prevalence amongst South Asians and $y$ is the prevalence amongst white British\n\nAlso\n\n$$\nx = y * 5\n$$\n\nCalculate prevalences:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nA <- matrix(c(1.54, 35, -1, 5), nrow=2, byrow=T)\nb <- c(4.9, 0)\nprev <- solve(A, b)\nprev\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5737705 0.1147541\n```\n:::\n:::\n\n\n## Model\n\nAssume threshold is the same in both populations. Establish a threshold based on European genetic architecture\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nsim1 <- function(mg, vg, me, ve, prev) {\n    n <- 100000\n    g <- rnorm(n, mg, sqrt(vg))\n    e <- rnorm(n, me, sqrt(ve))\n    l <- g + e\n    thresh <- quantile(l, 1-prev)\n    return(thresh)\n}\n\nthresh <- sim1(0, 0.4, 0, 0.6, prev[2])\nthresh\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n88.52459% \n 1.204965 \n```\n:::\n:::\n\n\nEstimate prevalence given a threshold when parameters change\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim2 <- function(mg, vg, me, ve, thresh) {\n    n <- 100000\n    g <- rnorm(n, mg, sqrt(vg))\n    e <- rnorm(n, me, sqrt(ve))\n    l <- g + e\n    prev <- sum(l > thresh) / n\n    return(prev)\n}\n\nsim2(0.1, 0.4, 0, 0.6, thresh)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.13381\n```\n:::\n:::\n\n\nEnumerate possibilities\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparam <- expand.grid(\n    mg = seq(0, 4, by=0.01),\n    vg = 0.4,\n    me = 0,\n    ve = 0.6,\n    thresh = thresh,\n    prev = NA\n)\n\nfor(i in 1:nrow(param)) {\n    param$prev[i] <- sim2(param$mg[i], param$vg[i], param$me[i], param$ve[i], param$thresh[i])\n}\n\nparam$ratio = param$prev / prev[2]\n\nggplot(param, aes(x=mg, y=ratio)) +\ngeom_line() +\ngeom_hline(yintercept=5, linetype=\"dotted\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThis shows how much larger the mean of the genetic liability would have to be to lead to 5x prevalence\n\nComparison of distributions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- param$mg[which(param$ratio >= 5)[1]]\nbind_rows(\n    tibble(pop=\"EUR\", x=seq(-3, 3, length.out=1000), val = dnorm(x, sd=sqrt(0.4))),\n    tibble(pop=\"SAS\", x=seq(-3+mg, 3+mg, length.out=1000), val = dnorm(x, m=mg, sd=sqrt(0.4)))\n) %>% ggplot(., aes(x=x, y=val)) +\ngeom_line(aes(colour=pop)) +\ngeom_vline(xintercept=thresh)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\nIs it plausible in terms of just different allele frequencies?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnsnp <- 10000\naf <- rbeta(nsnp, 1, 1) / 2\nhist(af)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nb <- rnorm(nsnp, 0, (2*af*(1-af))^-0.4)\nvg <- sum(b^2 * 2 * af * (1-af))\nb <- b / sqrt(vg) * 0.4\nplot(b ~ af)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nnid <- 1000\ng1 <- sapply(af, \\(x) { rbinom(nid, 2, x) })\nscore1 <- g1 %*% b\nhist(score1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\nsd(score1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.383443\n```\n:::\n:::\n\n\n\n## Summary\n\n- Seems unlikely under this model\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.6\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.1.4   ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.4       cli_3.6.1         knitr_1.45        rlang_1.1.2      \n [5] xfun_0.41         generics_0.1.3    jsonlite_1.8.7    labeling_0.4.2   \n [9] glue_1.6.2        colorspace_2.1-0  htmltools_0.5.7   scales_1.2.1     \n[13] fansi_1.0.5       rmarkdown_2.25    grid_4.3.2        evaluate_0.23    \n[17] munsell_0.5.0     tibble_3.2.1      fastmap_1.1.1     yaml_2.3.7       \n[21] lifecycle_1.0.4   compiler_4.3.2    htmlwidgets_1.6.3 pkgconfig_2.0.3  \n[25] farver_2.1.1      digest_0.6.33     R6_2.5.1          tidyselect_1.2.0 \n[29] utf8_1.2.4        pillar_1.9.0      magrittr_2.0.3    withr_2.5.2      \n[33] tools_4.3.2       gtable_0.3.3     \n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}