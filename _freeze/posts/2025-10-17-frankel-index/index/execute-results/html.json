{
  "hash": "306304fdf4af7b9bc9ba1cf128636f8b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Frankel's health attention index\"\nauthor: Gibran Hemani\ndate: \"2025-10-17\"\ncategories: []\n---\n\n## Background\n\nFrankel 1989 claimed that part of the issue of waiting lists was that professionals would prioritise treatment for things that were more fashionable rather than more urgent or prevalent.\n\nThis is the dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'data.table'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(knitr)\ndat <- fread(\"frankel-index.csv\")\nkable(dat)\n```\n\n::: {.cell-output-display}\n\n\n|Diagnoses                  | Discharges and deaths| Index of interest (Papers/D&D × 1000)|\n|:--------------------------|---------------------:|-------------------------------------:|\n|Slow virus diseases of CNS |                    40|                                2000.0|\n|Myasthenia Gravis          |                   930|                                 156.0|\n|Crohn’s disease            |                  6670|                                  44.0|\n|Carcinoma of the breast    |                 41220|                                  33.0|\n|Rheumatoid arthritis       |                 26060|                                  27.0|\n|Carcinoma of the bronchus  |                 54440|                                  20.0|\n|Myocardial infarction      |                102720|                                  10.0|\n|Cerebrovascular disease    |                111250|                                   7.7|\n|Irritable bowel etc.*      |                 19840|                                   6.7|\n|Cataract                   |                 54990|                                   6.5|\n|Hip replacement            |                 37400|                                   6.0|\n|Haemorrhoids               |                 20700|                                   5.0|\n|Inguinal hernia            |                 64400|                                   1.8|\n|Tonsils and adenoids       |                 76600|                                   0.7|\n|Varicose veins             |                 47160|                                   0.6|\n\n\n:::\n:::\n\n\nWork out the number of papers per disease\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(dat) <- c(\"disease\", \"dd\", \"index\")\ndat$papers <- dat$index * dat$dd / 1000\n```\n:::\n\n\nThe paper points out that there are a highly disproportionate number of papers for slow viruses of the CNS. But this claim might be a bit exaggerated by representing it as a ratio of two low numbers. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(dat, aes(x=dd, y=index)) +\ngeom_point() +\ngeom_text_repel(aes(label=disease), size=2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nInstead, plot papers against numbers of deaths and discharges\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(dat, aes(x=dd, y=papers)) +\ngeom_point() +\ngeom_text_repel(aes(label=disease), size=2) +\ngeom_smooth(method=\"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe fraction of all papers that were on the slow viruses of the CNS was 0.012. \n\nInequality analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rineq)\n\nout1 <- rineq::ci(\n    ineqvar = dat$papers,\n    outcome = dat$papers, \n    method = \"direct\"\n)\ngini <- tibble(\n    ci = out1$concentration_index,\n    ci_se = sqrt(out1$variance),\n    ci_lci = ci - 1.96 * ci_se,\n    ci_uci = ci + 1.96 * ci_se\n)\n\nout2 <- rineq::ci(\n    ineqvar = dat$papers,\n    outcome = dat$dd, \n    method = \"direct\"\n)\nciout <- tibble(\n    ci = out2$concentration_index,\n    ci_se = sqrt(out2$variance),\n    ci_lci = ci - 1.96 * ci_se,\n    ci_uci = ci + 1.96 * ci_se\n)\n\nmake_plot_dat <- function(x) {\n  myOrder <- order(x$fractional_rank)\n  xCoord <- x$fractional_rank[myOrder]\n  y <- x$outcome[myOrder]\n  cumdist <- cumsum(y) / sum(y)\n  tibble(xCoord, cumdist)\n}\n\nplot_dat <- bind_rows(\n    make_plot_dat(out1) %>% mutate(group=paste0(\"Number of papers (Gini index = \", round(out1$concentration_index, 2), \")\")), \n    make_plot_dat(out2) %>% mutate(group=paste0(\"Deaths and discharges (concentration index = \", round(out2$concentration_index, 2), \")\"))\n)\n\nggplot(aes(x = xCoord, y = cumdist, group = group), data = plot_dat) +\n  geom_line(aes(colour = group)) +\n  geom_abline(slope = 1, intercept = 0, linetype = \"dashed\") +\n  theme_bw() +\n  theme(legend.position = \"inside\", legend.position.inside=c(0.3,0.8)) +\n  labs(\n    x = \"Fractional rank of number of papers\",\n    y = \"Cumulative proportion of deaths and discharges\",\n    colour = \"Outcome\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThe concentration index has quite a large confidence interval\n\n\n::: {.cell}\n\n```{.r .cell-code}\nciout %>% kable\n```\n\n::: {.cell-output-display}\n\n\n|        ci|     ci_se|     ci_lci|    ci_uci|\n|---------:|---------:|----------:|---------:|\n| 0.1328638| 0.1044544| -0.0718669| 0.3375944|\n\n\n:::\n:::\n\n\n\n\n## Summary\n\nThere is some concordance between the inequality in disease attention and the disease impact.\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.5.1 (2025-06-13)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] rineq_0.3.0       knitr_1.50        ggrepel_0.9.6     ggplot2_3.5.2    \n[5] data.table_1.17.8 dplyr_1.1.4      \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.5        nlme_3.1-168       cli_3.6.5          rlang_1.1.6       \n [5] xfun_0.52          generics_0.1.4     jsonlite_2.0.0     labeling_0.4.3    \n [9] glue_1.8.0         htmltools_0.5.8.1  scales_1.4.0       rmarkdown_2.29    \n[13] grid_4.5.1         evaluate_1.0.4     tibble_3.3.0       fastmap_1.2.0     \n[17] yaml_2.3.10        lifecycle_1.0.4    compiler_4.5.1     RColorBrewer_1.1-3\n[21] Rcpp_1.1.0         htmlwidgets_1.6.4  pkgconfig_2.0.3    mgcv_1.9-3        \n[25] lattice_0.22-7     farver_2.1.2       digest_0.6.37      R6_2.6.1          \n[29] tidyselect_1.2.1   splines_4.5.1      pillar_1.11.0      magrittr_2.0.3    \n[33] Matrix_1.7-3       withr_3.0.2        tools_4.5.1        gtable_0.3.6      \n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}