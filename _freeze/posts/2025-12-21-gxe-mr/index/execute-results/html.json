{
  "hash": "73d3d73dd63b9b353f9e971cf1a13391",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"gxe-mr\"\nauthor: Gibran Hemani\ndate: \"2025-12-21\"\ncategories: []\n---\n\n## Background\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(simulateGP)\n\nmake_gxe <- function(g, e, b_add, b_int, b_e) {\n    n <- length(g)\n    stopifnot(length(g) != length(e))\n    y <- g * b_add + e * b_e + g * e * b_int\n    r <- rnorm(n, 0, sqrt(1 - var(y)))\n    y <- y + r\n    return(y)\n}\n\nsim <- function(nid, nsnp, b_add, b_e, b_int, pop_diff) {\n    g1 <- rbinom(nid, 2, 0.5)\n    g2 <- rbinom(nid, 2, sample(c(-1, 1), 1) * pop_diff + 0.5)\n\n    mean_e <- \n\n    e1 <- rnorm(nid, 0, 1)\n    e2 <- rnorm(nid, sample(c(-1, 1), 1) * pop_diff, 1)\n\n\n}\n\n\nparams <- expand.grid(\n    nid = 10000,\n    nsnp = 100,\n    b_add = 0.05,\n    b_e = 0.05,\n    b_int = c(0, 0.025, 0.05),\n    pop_diff = seq(0, 0.5, by=0.1)\n)\nparams\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     nid nsnp b_add  b_e b_int pop_diff\n1  10000  100  0.05 0.05 0.000      0.0\n2  10000  100  0.05 0.05 0.025      0.0\n3  10000  100  0.05 0.05 0.050      0.0\n4  10000  100  0.05 0.05 0.000      0.1\n5  10000  100  0.05 0.05 0.025      0.1\n6  10000  100  0.05 0.05 0.050      0.1\n7  10000  100  0.05 0.05 0.000      0.2\n8  10000  100  0.05 0.05 0.025      0.2\n9  10000  100  0.05 0.05 0.050      0.2\n10 10000  100  0.05 0.05 0.000      0.3\n11 10000  100  0.05 0.05 0.025      0.3\n12 10000  100  0.05 0.05 0.050      0.3\n13 10000  100  0.05 0.05 0.000      0.4\n14 10000  100  0.05 0.05 0.025      0.4\n15 10000  100  0.05 0.05 0.050      0.4\n16 10000  100  0.05 0.05 0.000      0.5\n17 10000  100  0.05 0.05 0.025      0.5\n18 10000  100  0.05 0.05 0.050      0.5\n```\n\n\n:::\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.5.2 (2025-10-31)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sequoia 15.2\n\nMatrix products: default\nBLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] simulateGP_0.1.3 dplyr_1.1.4     \n\nloaded via a namespace (and not attached):\n [1] digest_0.6.39     R6_2.6.1          fastmap_1.2.0     tidyselect_1.2.1 \n [5] xfun_0.54         magrittr_2.0.4    glue_1.8.0        tibble_3.3.0     \n [9] knitr_1.50        pkgconfig_2.0.3   htmltools_0.5.8.1 rmarkdown_2.30   \n[13] generics_0.1.4    lifecycle_1.0.4   cli_3.6.5         vctrs_0.6.5      \n[17] compiler_4.5.2    tools_4.5.2       pillar_1.11.1     evaluate_1.0.5   \n[21] yaml_2.3.11       rlang_1.1.6       jsonlite_2.0.0    htmlwidgets_1.6.4\n```\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}