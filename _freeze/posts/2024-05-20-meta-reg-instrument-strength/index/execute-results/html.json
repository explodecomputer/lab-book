{
  "hash": "155ccc1e62c4829ea62cd9126e538587",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Meta regression of instrument strength\"\nauthor: \"Si Fang, Gibran Hemani\"\ndate: \"2024-05-20\"\ncategories: []\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(meta)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: metadat\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading 'meta' package (version 7.0-0).\nType 'help(meta)' for a brief overview.\nReaders of 'Meta-Analysis with R (Use R!)' should install\nolder version of 'meta' package: https://tinyurl.com/dt4y5drs\n```\n\n\n:::\n:::\n\n\n## Height on EduYears\n\n\n::: {.cell}\n\n```{.r .cell-code}\naivw <- read.csv(\"~/Downloads/MR_heightonEduYears_testing_different_pval_interval.txt\") %>%\n    filter(method==\"Inverse variance weighted\") %>%\n    mutate(log10p = -log10(P_iv_max), lin = order(log10p))\naivw\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   id.exposure id.outcome  outcome       exposure                    method\n1       nm98hp     5Sp9Mo EduYears Height (Yengo) Inverse variance weighted\n2       NyafI4     Q6QEYQ EduYears Height (Yengo) Inverse variance weighted\n3       GQJeVE     jBuRrA EduYears Height (Yengo) Inverse variance weighted\n4       UZvxlp     JA1stj EduYears Height (Yengo) Inverse variance weighted\n5       QaYHQF     gQdDyF EduYears Height (Yengo) Inverse variance weighted\n6       qEwYAa     7vl76I EduYears Height (Yengo) Inverse variance weighted\n7       E98G7Y     jcD8c3 EduYears Height (Yengo) Inverse variance weighted\n8       MWJlpr     ijYeII EduYears Height (Yengo) Inverse variance weighted\n9       4F1nwV     gVGM5a EduYears Height (Yengo) Inverse variance weighted\n10      jZgM7S     Zmdbd9 EduYears Height (Yengo) Inverse variance weighted\n11      ObJ1fr     uAyFYH EduYears Height (Yengo) Inverse variance weighted\n   nsnp          b         se         pval P_iv_max P_iv_min          F\n1   645 0.13097037 0.02087832 3.540830e-10    5e-08    1e-08   32.10485\n2   676 0.11035679 0.01936088 1.198155e-08    1e-08    1e-09   36.35068\n3   635 0.08279502 0.01915875 1.549543e-05    1e-09    1e-10   40.79298\n4   600 0.10848367 0.01930061 1.901430e-08    1e-10    1e-11   45.24754\n5   678 0.08589255 0.01715382 5.522850e-07    1e-11    1e-13   53.09666\n6   576 0.07562120 0.01775213 2.045756e-05    1e-13    1e-15   62.17613\n7   698 0.05253911 0.01014079 2.207359e-07    1e-15    1e-50  160.07505\n8   304 0.07038636 0.01077802 6.553117e-11    1e-50   1e-100  359.12485\n9   158 0.05372085 0.01155859 3.356609e-06   1e-100   1e-200  689.29865\n10   51 0.02970045 0.01378883 3.124413e-02   1e-200   1e-300 1203.06617\n11   28 0.03539893 0.01424702 1.296773e-02   1e-300    0e+00 1824.83185\n      ci_lower   ci_upper       P_iv_range    log10p lin\n1  0.090048865 0.17189187   5e-08 to 1e-08   7.30103   1\n2  0.072409466 0.14830411   1e-08 to 1e-09   8.00000   2\n3  0.045243872 0.12034617   1e-09 to 1e-10   9.00000   3\n4  0.070654477 0.14631286   1e-10 to 1e-11  10.00000   4\n5  0.052271063 0.11951404   1e-11 to 1e-13  11.00000   5\n6  0.040827018 0.11041537   1e-13 to 1e-15  13.00000   6\n7  0.032663165 0.07241505   1e-15 to 1e-50  15.00000   7\n8  0.049261432 0.09151128  1e-50 to 1e-100  50.00000   8\n9  0.031066005 0.07637570 1e-100 to 1e-200 100.00000   9\n10 0.002674339 0.05672657 1e-200 to 1e-300 200.00000  10\n11 0.007474760 0.06332309      1e-300 to 0 300.00000  11\n```\n\n\n:::\n:::\n\n\nPerform meta analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- meta::metagen(b, se, data=aivw)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of studies: k = 11\n\n                                      95%-CI     z  p-value\nCommon effect model  0.0660 [0.0575; 0.0745] 15.18 < 0.0001\nRandom effects model 0.0731 [0.0549; 0.0913]  7.88 < 0.0001\n\nQuantifying heterogeneity:\n tau^2 = 0.0007 [0.0002; 0.0029]; tau = 0.0264 [0.0155; 0.0536]\n I^2 = 72.8% [50.2%; 85.2%]; H = 1.92 [1.42; 2.60]\n\nTest of heterogeneity:\n     Q d.f.  p-value\n 36.78   10 < 0.0001\n\nDetails on meta-analytical method:\n- Inverse variance method\n- Restricted maximum-likelihood estimator for tau^2\n- Q-Profile method for confidence interval of tau^2 and tau\n```\n\n\n:::\n:::\n\n\nSubstantial heterogeneity. Perform meta regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu2 <- update(m1, subgroup = aivw$log10p, tau.common = TRUE, common = FALSE)\nmetareg(mu2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMixed-Effects Model (k = 11; tau^2 estimator: REML)\n\ntau^2 (estimated amount of residual heterogeneity):     0.0003 (SE = 0.0002)\ntau (square root of estimated tau^2 value):             0.0160\nI^2 (residual heterogeneity / unaccounted variability): 54.41%\nH^2 (unaccounted variability / sampling variability):   2.19\nR^2 (amount of heterogeneity accounted for):            63.05%\n\nTest for Residual Heterogeneity:\nQE(df = 9) = 19.5765, p-val = 0.0207\n\nTest of Moderators (coefficient 2):\nQM(df = 1) = 9.8294, p-val = 0.0017\n\nModel Results:\n\n           estimate      se     zval    pval    ci.lb    ci.ub      \nintrcpt      0.0871  0.0085  10.2613  <.0001   0.0704   0.1037  *** \n.subgroup   -0.0002  0.0001  -3.1352  0.0017  -0.0004  -0.0001   ** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nStrong relationship with instrument strength\n\nPlot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbubble(metareg(mu2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nTry using a different scale of instrument strength\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu3 <- update(m1, subgroup = aivw$lin, tau.common = TRUE, common = FALSE)\nmetareg(mu3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMixed-Effects Model (k = 11; tau^2 estimator: REML)\n\ntau^2 (estimated amount of residual heterogeneity):     0 (SE = 0.0001)\ntau (square root of estimated tau^2 value):             0\nI^2 (residual heterogeneity / unaccounted variability): 0.00%\nH^2 (unaccounted variability / sampling variability):   1.00\nR^2 (amount of heterogeneity accounted for):            100.00%\n\nTest for Residual Heterogeneity:\nQE(df = 9) = 6.0556, p-val = 0.7343\n\nTest of Moderators (coefficient 2):\nQM(df = 1) = 30.7289, p-val < .0001\n\nModel Results:\n\n           estimate      se     zval    pval    ci.lb    ci.ub      \nintrcpt      0.1280  0.0120  10.6661  <.0001   0.1044   0.1515  *** \n.subgroup   -0.0088  0.0016  -5.5434  <.0001  -0.0119  -0.0057  *** \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nStronger relationship with instrument strength now\n\nPlot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbubble(metareg(mu3))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n## Height on CHD\n\n\n::: {.cell}\n\n```{.r .cell-code}\naivw <- read.csv(\"~/Downloads/MR_heightonCHD_testing_different_pval_interval.txt\") %>%\n    filter(method==\"Inverse variance weighted\") %>%\n    mutate(log10p = -log10(P_iv_max), lin = order(log10p))\naivw\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   id.exposure id.outcome outcome       exposure                    method nsnp\n1       4avJf8     zKPwTu     CAD Height (Yengo) Inverse variance weighted  647\n2       zPVfio     KmlZaD     CAD Height (Yengo) Inverse variance weighted  680\n3       ggVTS5     D8MkL0     CAD Height (Yengo) Inverse variance weighted  635\n4       J4T1SY     9CRjl6     CAD Height (Yengo) Inverse variance weighted  601\n5       mSLst6     ZGtRpI     CAD Height (Yengo) Inverse variance weighted  683\n6       P1PeFO     WfZZs8     CAD Height (Yengo) Inverse variance weighted  577\n7       AYBY9X     OSpAFM     CAD Height (Yengo) Inverse variance weighted  704\n8       kiUsLi     O3lyFq     CAD Height (Yengo) Inverse variance weighted  307\n9       n3Pwg1     0kqLPQ     CAD Height (Yengo) Inverse variance weighted  160\n10      sV6BCB     5jXthQ     CAD Height (Yengo) Inverse variance weighted   52\n11      5CeibS     Q89sMQ     CAD Height (Yengo) Inverse variance weighted   28\n             b         se         pval P_iv_max P_iv_min          F   ci_lower\n1  -0.21922201 0.05741487 1.344237e-04    5e-08    1e-08   32.10439 -0.3317552\n2  -0.06273335 0.05409298 2.461580e-01    1e-08    1e-09   36.34657 -0.1687556\n3  -0.04340697 0.05656671 4.428681e-01    1e-09    1e-10   40.79436 -0.1542777\n4  -0.15929291 0.05112851 1.836085e-03    1e-10    1e-11   45.24438 -0.2595048\n5  -0.06463327 0.04377523 1.398150e-01    1e-11    1e-13   53.09435 -0.1504327\n6  -0.07308372 0.04965172 1.410405e-01    1e-13    1e-15   62.17247 -0.1704011\n7  -0.12846361 0.02706783 2.074899e-06    1e-15    1e-50  159.87766 -0.1815166\n8  -0.12368008 0.02804608 1.034239e-05    1e-50   1e-100  359.11038 -0.1786504\n9  -0.08252363 0.02863959 3.958459e-03   1e-100   1e-200  689.17024 -0.1386572\n10 -0.08436993 0.03582866 1.853185e-02   1e-200   1e-300 1203.58664 -0.1545941\n11  0.02059197 0.05479284 7.070545e-01   1e-300    0e+00 1824.83185 -0.0868020\n      ci_upper       P_iv_range    log10p lin\n1  -0.10668887   5e-08 to 1e-08   7.30103   1\n2   0.04328890   1e-08 to 1e-09   8.00000   2\n3   0.06746379   1e-09 to 1e-10   9.00000   3\n4  -0.05908103   1e-10 to 1e-11  10.00000   4\n5   0.02116618   1e-11 to 1e-13  11.00000   5\n6   0.02423365   1e-13 to 1e-15  13.00000   6\n7  -0.07541067   1e-15 to 1e-50  15.00000   7\n8  -0.06870976  1e-50 to 1e-100  50.00000   8\n9  -0.02639004 1e-100 to 1e-200 100.00000   9\n10 -0.01414575 1e-200 to 1e-300 200.00000  10\n11  0.12798594      1e-300 to 0 300.00000  11\n```\n\n\n:::\n:::\n\n\nPerform meta analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- meta::metagen(b, se, data=aivw)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNumber of studies: k = 11\n\n                                         95%-CI     z  p-value\nCommon effect model  -0.0992 [-0.1223; -0.0762] -8.44 < 0.0001\nRandom effects model -0.0975 [-0.1241; -0.0709] -7.18 < 0.0001\n\nQuantifying heterogeneity:\n tau^2 = 0.0004 [0.0000; 0.0095]; tau = 0.0197 [0.0000; 0.0974]\n I^2 = 34.6% [0.0%; 67.9%]; H = 1.24 [1.00; 1.76]\n\nTest of heterogeneity:\n     Q d.f. p-value\n 15.30   10  0.1215\n\nDetails on meta-analytical method:\n- Inverse variance method\n- Restricted maximum-likelihood estimator for tau^2\n- Q-Profile method for confidence interval of tau^2 and tau\n```\n\n\n:::\n:::\n\n\nWeak heterogeneity. Perform meta regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu2 <- update(m1, subgroup = aivw$log10p, tau.common = TRUE, common = FALSE)\nmetareg(mu2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMixed-Effects Model (k = 11; tau^2 estimator: REML)\n\ntau^2 (estimated amount of residual heterogeneity):     0.0000 (SE = 0.0006)\ntau (square root of estimated tau^2 value):             0.0008\nI^2 (residual heterogeneity / unaccounted variability): 0.04%\nH^2 (unaccounted variability / sampling variability):   1.00\nR^2 (amount of heterogeneity accounted for):            99.82%\n\nTest for Residual Heterogeneity:\nQE(df = 9) = 10.7402, p-val = 0.2939\n\nTest of Moderators (coefficient 2):\nQM(df = 1) = 4.5576, p-val = 0.0328\n\nModel Results:\n\n           estimate      se     zval    pval    ci.lb    ci.ub      \nintrcpt     -0.1206  0.0155  -7.8060  <.0001  -0.1509  -0.0903  *** \n.subgroup    0.0003  0.0001   2.1349  0.0328   0.0000   0.0006    * \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nSome relationship with instrument strength\n\nPlot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbubble(metareg(mu2))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\nTry again using a different scale for instrument strength\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu3 <- update(m1, subgroup = aivw$lin, tau.common = TRUE, common = FALSE)\nmetareg(mu3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMixed-Effects Model (k = 11; tau^2 estimator: REML)\n\ntau^2 (estimated amount of residual heterogeneity):     0.0004 (SE = 0.0009)\ntau (square root of estimated tau^2 value):             0.0212\nI^2 (residual heterogeneity / unaccounted variability): 22.49%\nH^2 (unaccounted variability / sampling variability):   1.29\nR^2 (amount of heterogeneity accounted for):            0.00%\n\nTest for Residual Heterogeneity:\nQE(df = 9) = 13.3023, p-val = 0.1494\n\nTest of Moderators (coefficient 2):\nQM(df = 1) = 1.8348, p-val = 0.1756\n\nModel Results:\n\n           estimate      se     zval    pval    ci.lb    ci.ub      \nintrcpt     -0.1434  0.0367  -3.9067  <.0001  -0.2153  -0.0714  *** \n.subgroup    0.0068  0.0050   1.3545  0.1756  -0.0030   0.0166      \n\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nWeaker relationship with instrument strength \n\nPlot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbubble(metareg(mu3))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## Background\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.0 (2024-04-24)\nPlatform: x86_64-apple-darwin20\nRunning under: macOS Ventura 13.6\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] meta_7.0-0    metadat_1.2-0 dplyr_1.1.4  \n\nloaded via a namespace (and not attached):\n [1] Matrix_1.7-0        jsonlite_1.8.8      compiler_4.4.0     \n [4] tidyselect_1.2.1    Rcpp_1.0.12         xml2_1.3.6         \n [7] stringr_1.5.1       metafor_4.6-0       splines_4.4.0      \n[10] boot_1.3-30         yaml_2.3.8          fastmap_1.1.1      \n[13] lattice_0.22-6      readr_2.1.5         R6_2.5.1           \n[16] generics_0.1.3      knitr_1.46          htmlwidgets_1.6.4  \n[19] MASS_7.3-60.2       tibble_3.2.1        nloptr_2.0.3       \n[22] minqa_1.2.6         tzdb_0.4.0          pillar_1.9.0       \n[25] rlang_1.1.3         utf8_1.2.4          stringi_1.8.3      \n[28] mathjaxr_1.6-0      xfun_0.43           cli_3.6.2          \n[31] magrittr_2.0.3      digest_0.6.35       grid_4.4.0         \n[34] hms_1.1.3           lme4_1.1-35.3       lifecycle_1.0.4    \n[37] CompQuadForm_1.4.3  nlme_3.1-164        vctrs_0.6.5        \n[40] evaluate_0.23       glue_1.7.0          numDeriv_2016.8-1.1\n[43] fansi_1.0.6         purrr_1.0.2         rmarkdown_2.26     \n[46] tools_4.4.0         pkgconfig_2.0.3     htmltools_0.5.8.1  \n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}