{
  "hash": "fc69beee687400783de6d395bf2a1934",
  "result": {
    "markdown": "---\ntitle: \"Standard errors of MR GxE\"\nauthor: Gibran Hemani\ndate: \"2023-12-01\"\ncategories: []\n---\n\n\n## Background\n\nCoding the MR-GxE model to have standard errors obtained through parametric bootstrap\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nest <- function(b_gx, se_gx, b_gy, se_gy, nboot=1000) {\n    npop <- length(b_gx)\n    stopifnot(length(se_gx) == npop)\n    stopifnot(length(b_gy) == npop)\n    stopifnot(length(se_gy) == npop)\n    \n    mod <- summary(lm(b_gy ~ b_gx))\n\n    # standard errors\n    o <- lapply(1:nboot, \\(i) {\n        bgxb <- rnorm(npop, b_gx, se_gx)\n        bgyb <- rnorm(npop, b_gy, se_gy)\n        modb <- summary(lm(bgyb ~ bgxb))$coef\n        tibble(boot=i, a=modb[1,1], b=modb[2,1])\n    }) %>% bind_rows()\n\n    res <- tibble(\n        a = mod$coef[1,1],\n        b = mod$coef[2,1],\n        a_se = sd(o$a),\n        b_se = sd(o$b),\n        a_pval = pnorm(abs(a) / a_se, lower.tail=FALSE),\n        b_pval = pnorm(abs(b) / b_se, lower.tail=FALSE),\n        a_mean = mean(o$a),\n        b_mean = mean(o$b)\n    ) %>% as.list()\n    return(res)\n}\n\no <- est(\n    b_gx=c(0, 1),\n    se_gx = c(0.2, 0.2),\n    b_gy=c(1, 1),\n    se_gy = c(0.2, 0.2)\n)\no\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$a\n[1] 1\n\n$b\n[1] 2.507433e-16\n\n$a_se\n[1] 0.227826\n\n$b_se\n[1] 0.3302168\n\n$a_pval\n[1] 5.685413e-06\n\n$b_pval\n[1] 0.5\n\n$a_mean\n[1] 1.004683\n\n$b_mean\n[1] -0.00958491\n```\n:::\n:::\n\n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.6\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.1.4\n\nloaded via a namespace (and not attached):\n [1] digest_0.6.33     utf8_1.2.4        R6_2.5.1          fastmap_1.1.1    \n [5] tidyselect_1.2.0  xfun_0.41         magrittr_2.0.3    glue_1.6.2       \n [9] tibble_3.2.1      knitr_1.45        pkgconfig_2.0.3   htmltools_0.5.7  \n[13] rmarkdown_2.25    generics_0.1.3    lifecycle_1.0.4   cli_3.6.1        \n[17] fansi_1.0.5       vctrs_0.6.4       compiler_4.3.2    tools_4.3.2      \n[21] pillar_1.9.0      evaluate_0.23     yaml_2.3.7        rlang_1.1.2      \n[25] jsonlite_1.8.7    htmlwidgets_1.6.3\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}