{
  "hash": "f87ea07f2de9e5f73d694cb13c45c7b6",
  "result": {
    "markdown": "---\ntitle: \"Overlapping genes\"\nauthor: Gibran Hemani\ndate: \"2023-02-18\"\ncategories: [genomics]\n---\n\n\n## Background\n\nFor a list of positions, identify all genes that overlap +/- 200kb.\n\nUse Ensembl database of gene positions \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(EnsDb.Hsapiens.v75) # For convenience hg19\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: ensembldb\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: BiocGenerics\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'BiocGenerics'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, aperm, append, as.data.frame, basename, cbind,\n    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,\n    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,\n    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,\n    Position, rank, rbind, Reduce, rownames, sapply, setdiff, sort,\n    table, tapply, union, unique, unsplit, which.max, which.min\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: GenomicRanges\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: stats4\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: S4Vectors\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'S4Vectors'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: IRanges\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: GenomeInfoDb\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GenomeInfoDb' was built under R version 4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: GenomicFeatures\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GenomicFeatures' was built under R version 4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: AnnotationDbi\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Biobase\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: AnnotationFilter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ensembldb'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(ieugwasr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nAPI: public: http://gwas-api.mrcieu.ac.uk/\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ieugwasr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:IRanges':\n\n    cor\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:S4Vectors':\n\n    cor\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:ensembldb':\n\n    filter, select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:AnnotationDbi':\n\n    select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:Biobase':\n\n    combine\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:GenomicRanges':\n\n    intersect, setdiff, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:GenomeInfoDb':\n\n    intersect\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:IRanges':\n\n    collapse, desc, intersect, setdiff, slice, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:S4Vectors':\n\n    first, intersect, rename, setdiff, setequal, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:BiocGenerics':\n\n    combine, intersect, setdiff, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\ngenelist <- genes(EnsDb.Hsapiens.v75) %>% \n    subset(., gene_biotype==\"protein_coding\")\ngenelist\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGRanges object with 22810 ranges and 6 metadata columns:\n                  seqnames            ranges strand |         gene_id\n                     <Rle>         <IRanges>  <Rle> |     <character>\n  ENSG00000186092        1       69091-70008      + | ENSG00000186092\n  ENSG00000237683        1     134901-139379      - | ENSG00000237683\n  ENSG00000235249        1     367640-368634      + | ENSG00000235249\n  ENSG00000185097        1     621059-622053      - | ENSG00000185097\n  ENSG00000269831        1     738532-739137      - | ENSG00000269831\n              ...      ...               ...    ... .             ...\n  ENSG00000187191        Y 26909216-26959626      - | ENSG00000187191\n  ENSG00000205916        Y 26980008-27053183      + | ENSG00000205916\n  ENSG00000185894        Y 27177048-27208695      - | ENSG00000185894\n  ENSG00000172288        Y 27768264-27771049      + | ENSG00000172288\n  ENSG00000269393        Y 28111776-28114889      - | ENSG00000269393\n                    gene_name   gene_biotype seq_coord_system      symbol\n                  <character>    <character>      <character> <character>\n  ENSG00000186092       OR4F5 protein_coding       chromosome       OR4F5\n  ENSG00000237683  AL627309.1 protein_coding       chromosome  AL627309.1\n  ENSG00000235249      OR4F29 protein_coding       chromosome      OR4F29\n  ENSG00000185097      OR4F16 protein_coding       chromosome      OR4F16\n  ENSG00000269831  AL669831.1 protein_coding       chromosome  AL669831.1\n              ...         ...            ...              ...         ...\n  ENSG00000187191        DAZ3 protein_coding       chromosome        DAZ3\n  ENSG00000205916        DAZ4 protein_coding       chromosome        DAZ4\n  ENSG00000185894       BPY2C protein_coding       chromosome       BPY2C\n  ENSG00000172288        CDY1 protein_coding       chromosome        CDY1\n  ENSG00000269393  AC007965.1 protein_coding       chromosome  AC007965.1\n                                    entrezid\n                                      <list>\n  ENSG00000186092                      79501\n  ENSG00000237683 101929819,100996768,728728\n  ENSG00000235249         729759,81399,26683\n  ENSG00000185097         729759,81399,26683\n  ENSG00000269831                       <NA>\n              ...                        ...\n  ENSG00000187191                57055,57054\n  ENSG00000205916           57135,57055,1617\n  ENSG00000185894         442868,442867,9083\n  ENSG00000172288                253175,9085\n  ENSG00000269393                       <NA>\n  -------\n  seqinfo: 273 sequences (1 circular) from GRCh37 genome\n```\n:::\n:::\n\n\nSNP list\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnps_cluster1 <- c(\"rs1097327\",\"rs2186120\",\"rs2166172\",\"rs75641275\",\"rs12037698\",\"rs1446585\",\"rs16846140\",\"rs13062093\",\"rs2051559\",\"rs6861649\",\"rs2281819\",\"rs12662900\",\"rs9388681\",\"rs17132130\",\"rs215634\",\"rs79682948\",\"rs2192649\",\"rs13294945\",\"rs7357754\",\"rs4749937\",\"rs1465900\",\"rs1799992\",\"rs55938344\",\"rs7987928\",\"rs7331420\",\"rs9522279\",\"rs55689274\",\"rs4777541\",\"rs7189149\",\"rs11079849\",\"rs113230003\",\"rs150998792\")\n```\n:::\n\n\nGet positions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbmi <- associations(snps_cluster1, \"ukb-a-248\")\ntarget <- GRanges(bmi$chr, IRanges(bmi$position - 200000, bmi$position + 200000))\ntarget\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGRanges object with 30 ranges and 0 metadata columns:\n       seqnames              ranges strand\n          <Rle>           <IRanges>  <Rle>\n   [1]        1   23137075-23537075      *\n   [2]        1   66253163-66653163      *\n   [3]        1   91008514-91408514      *\n   [4]        1   98127133-98527133      *\n   [5]        1 243384345-243784345      *\n   ...      ...                 ...    ...\n  [26]       15   47558909-47958909      *\n  [27]       15   72882240-73282240      *\n  [28]       16   68944151-69344151      *\n  [29]       17   46890785-47290785      *\n  [30]       19   18260956-18660956      *\n  -------\n  seqinfo: 16 sequences from an unspecified genome; no seqlengths\n```\n:::\n:::\n\n\nFind overlaps with genelist\n\n\n::: {.cell}\n\n```{.r .cell-code}\noverlaps <- findOverlaps(target, genelist)\noverlaps\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHits object with 116 hits and 0 metadata columns:\n        queryHits subjectHits\n        <integer>   <integer>\n    [1]         1         306\n    [2]         1         307\n    [3]         1         308\n    [4]         1         309\n    [5]         1         310\n    ...       ...         ...\n  [112]        30        9758\n  [113]        30        9759\n  [114]        30        9760\n  [115]        30        9761\n  [116]        30        9762\n  -------\n  queryLength: 30 / subjectLength: 22810\n```\n:::\n:::\n\n\nOverall about 116 overlapping protein coding genes found for 30 SNPs.\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.2.1 Patched (2022-09-06 r82817)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Monterey 12.6.2\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] dplyr_1.0.10              ieugwasr_0.1.5           \n [3] EnsDb.Hsapiens.v75_2.99.0 ensembldb_2.22.0         \n [5] AnnotationFilter_1.22.0   GenomicFeatures_1.50.4   \n [7] AnnotationDbi_1.60.0      Biobase_2.56.0           \n [9] GenomicRanges_1.50.2      GenomeInfoDb_1.34.9      \n[11] IRanges_2.32.0            S4Vectors_0.36.1         \n[13] BiocGenerics_0.44.0      \n\nloaded via a namespace (and not attached):\n [1] MatrixGenerics_1.8.1        httr_1.4.4                 \n [3] bit64_4.0.5                 jsonlite_1.8.4             \n [5] assertthat_0.2.1            BiocFileCache_2.4.0        \n [7] blob_1.2.3                  GenomeInfoDbData_1.2.8     \n [9] Rsamtools_2.14.0            yaml_2.3.6                 \n[11] progress_1.2.2              pillar_1.8.1               \n[13] RSQLite_2.2.20              lattice_0.20-45            \n[15] glue_1.6.2                  digest_0.6.31              \n[17] XVector_0.38.0              htmltools_0.5.4            \n[19] Matrix_1.4-1                XML_3.99-0.13              \n[21] pkgconfig_2.0.3             biomaRt_2.54.0             \n[23] zlibbioc_1.42.0             BiocParallel_1.30.4        \n[25] tibble_3.1.8                KEGGREST_1.38.0            \n[27] generics_0.1.3              ellipsis_0.3.2             \n[29] cachem_1.0.6                SummarizedExperiment_1.28.0\n[31] lazyeval_0.2.2              cli_3.5.0                  \n[33] magrittr_2.0.3              crayon_1.5.2               \n[35] memoise_2.0.1               evaluate_0.19              \n[37] fansi_1.0.3                 xml2_1.3.3                 \n[39] tools_4.2.1                 prettyunits_1.1.1          \n[41] hms_1.1.2                   BiocIO_1.8.0               \n[43] lifecycle_1.0.3             matrixStats_0.63.0         \n[45] stringr_1.5.0               DelayedArray_0.24.0        \n[47] Biostrings_2.66.0           compiler_4.2.1             \n[49] rlang_1.0.6                 grid_4.2.1                 \n[51] RCurl_1.98-1.9              rjson_0.2.21               \n[53] rappdirs_0.3.3              htmlwidgets_1.5.4          \n[55] bitops_1.0-7                rmarkdown_2.16             \n[57] restfulr_0.0.15             codetools_0.2-18           \n[59] DBI_1.1.3                   curl_4.3.3                 \n[61] R6_2.5.1                    GenomicAlignments_1.34.0   \n[63] knitr_1.41                  rtracklayer_1.58.0         \n[65] fastmap_1.1.0               bit_4.0.5                  \n[67] utf8_1.2.2                  filelock_1.0.2             \n[69] ProtGenerics_1.30.0         stringi_1.7.8              \n[71] parallel_4.2.1              Rcpp_1.0.9                 \n[73] vctrs_0.5.1                 png_0.1-8                  \n[75] dbplyr_2.2.1                tidyselect_1.2.0           \n[77] xfun_0.36                  \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}