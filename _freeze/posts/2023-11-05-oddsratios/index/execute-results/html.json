{
  "hash": "3925d9767c56a26e1904af9bedc1ded5",
  "result": {
    "markdown": "---\ntitle: \"Do odds ratios change for varying prevalence?\"\nauthor: Gibran Hemani\ndate: \"2023-11-05\"\ncategories: []\n---\n\n\n## Background\n\nDisease prevalence may change across ancestries but effect sizes stay the same. Does this lead to different effect estimates?\n\nmean of risk factor changes - does it influence beta hat?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\np <- expand.grid(\n    b=c(-1, 0.5, 0, 0.5, 1),\n    m=seq(-0.8, 0.8, by=0.1),\n    bhat=NA,\n    prev=NA\n)\n\nn <- 10000\nfor(i in 1:nrow(p)) {\n    a <- rnorm(n, mean=p$m[i])\n    b <- a * p$b[i] + rnorm(n)\n    d <- rbinom(n, 1, plogis(b))\n    p$bhat[i] <- glm(d ~ a, family=\"binomial\")$coef[2]\n    p$prev[i] <- mean(d)\n}\n\nggplot(p, aes(x=prev, y=bhat)) +\ngeom_point(aes(colour=m)) +\nfacet_grid(. ~ b)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nno influence.\n\nWhat about if prevalence changes due to another factor\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- expand.grid(\n    b=c(-1, 0.5, 0, 0.5, 1),\n    m1=seq(-0.8, 0.8, by=0.1),\n    m2=seq(-0.8, 0.8, by=0.1),\n    bhat=NA,\n    prev=NA\n)\n\nn <- 10000\nfor(i in 1:nrow(p)) {\n    a <- rnorm(n, mean=p$m1[i])\n    a1 <- rnorm(n, mean=p$m2[i])\n    b <- a * p$b[i] + rnorm(n) + a1\n    d <- rbinom(n, 1, plogis(b))\n    p$bhat[i] <- glm(d ~ a, family=\"binomial\")$coef[2]\n    p$prev[i] <- mean(d)\n}\n\nggplot(p, aes(x=prev, y=bhat)) +\ngeom_point(aes(colour=m2)) +\nfacet_grid(m1 ~ b)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(lm(bhat ~ m1 + m2, p))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = bhat ~ m1 + m2, data = p)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.9782 -0.1597  0.2058  0.2426  0.6615 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  0.146779   0.013228  11.096   <2e-16 ***\nm1          -0.001546   0.027002  -0.057    0.954    \nm2          -0.001075   0.027002  -0.040    0.968    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5028 on 1442 degrees of freedom\nMultiple R-squared:  3.373e-06,\tAdjusted R-squared:  -0.001384 \nF-statistic: 0.002432 on 2 and 1442 DF,  p-value: 0.9976\n```\n:::\n:::\n\n\nno influence\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.6\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggplot2_3.4.2 dplyr_1.1.2  \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.3       cli_3.6.1         knitr_1.43        rlang_1.1.1      \n [5] xfun_0.39         generics_0.1.3    jsonlite_1.8.7    labeling_0.4.2   \n [9] glue_1.6.2        colorspace_2.1-0  htmltools_0.5.5   scales_1.2.1     \n[13] fansi_1.0.4       rmarkdown_2.22    grid_4.3.0        munsell_0.5.0    \n[17] evaluate_0.21     tibble_3.2.1      fastmap_1.1.1     yaml_2.3.7       \n[21] lifecycle_1.0.3   compiler_4.3.0    htmlwidgets_1.6.2 pkgconfig_2.0.3  \n[25] rstudioapi_0.14   farver_2.1.1      digest_0.6.31     R6_2.5.1         \n[29] tidyselect_1.2.0  utf8_1.2.3        pillar_1.9.0      magrittr_2.0.3   \n[33] withr_2.5.0       tools_4.3.0       gtable_0.3.3     \n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}