{
  "hash": "ee283fd5f14d748e1f60d51e68f1c6c8",
  "result": {
    "markdown": "---\ntitle: \"Interactions and scale\"\nauthor: Gibran Hemani\ndate: \"2023-07-05\"\ncategories: []\n---\n\n\n## Background\n\nAbsolute and relative risks will change across populations if the baseline risks are different.\n\nFor example, suppose BMI increases CHD by 20% per SD. BMI is distributed differently in two populations\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nn <- 10000000\n\ndat <- tibble(\n    bmi_1 = rnorm(n, 25, sd=5),\n    bmi_2 = rnorm(n, 20, sd=5),\n    chdr_1 = 0.2,\n    chdr_2 = 0.2\n)\n\n\n\ndat$chdr_1[dat$bmi_1 > 27] <- 0.2*1.5\ndat$chdr_2[dat$bmi_2 > 27] <- 0.2*1.5\n\ndat$chd_1 <- rbinom(n, 1, dat$chdr_1)\ndat$chd_2 <- rbinom(n, 1, dat$chdr_2)\n\ndat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10,000,000 × 6\n   bmi_1 bmi_2 chdr_1 chdr_2 chd_1 chd_2\n   <dbl> <dbl>  <dbl>  <dbl> <int> <int>\n 1  17.9  22.4    0.2    0.2     0     0\n 2  31.9  20.3    0.3    0.2     0     0\n 3  24.1  23.3    0.2    0.2     0     0\n 4  21.2  21.6    0.2    0.2     0     1\n 5  28.5  13.7    0.3    0.2     1     1\n 6  21.6  30.7    0.2    0.3     1     0\n 7  26.6  19.3    0.2    0.2     0     0\n 8  18.8  25.9    0.2    0.2     0     0\n 9  21.0  26.6    0.2    0.2     0     1\n10  25.1  24.1    0.2    0.2     1     0\n# ℹ 9,999,990 more rows\n```\n:::\n\n```{.r .cell-code}\nmean(dat$chdr_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2344512\n```\n:::\n\n```{.r .cell-code}\nmean(dat$chdr_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2080624\n```\n:::\n\n```{.r .cell-code}\nmean(dat$chd_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2345312\n```\n:::\n\n```{.r .cell-code}\nmean(dat$chd_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2079281\n```\n:::\n\n```{.r .cell-code}\nrr1 <- mean(dat$chd_1[dat$bmi_1 > 27]) / mean(dat$chd_1)\nrr2 <- mean(dat$chd_2[dat$bmi_2 > 27]) / mean(dat$chd_2)\nrr1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.279043\n```\n:::\n\n```{.r .cell-code}\nrr2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.440206\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglm(chd_1 ~ bmi_1, dat, family=\"binomial\")$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     bmi_1 \n0.04133235 \n```\n:::\n\n```{.r .cell-code}\nglm(chd_2 ~ bmi_2, dat, family=\"binomial\")$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     bmi_2 \n0.01829569 \n```\n:::\n\n```{.r .cell-code}\nglm(chd_1 ~ bmi_1>27, dat, family=\"binomial\")$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_1 > 27TRUE \n     0.5380365 \n```\n:::\n\n```{.r .cell-code}\nglm(chd_2 ~ bmi_2>27, dat, family=\"binomial\")$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_2 > 27TRUE \n     0.5370367 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(chd_1 ~ bmi_1>27, dat)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_1 > 27TRUE \n    0.09984052 \n```\n:::\n\n```{.r .cell-code}\nlm(chd_2 ~ bmi_2>27, dat)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_2 > 27TRUE \n    0.09955787 \n```\n:::\n\n```{.r .cell-code}\nlm(chd_1 ~ bmi_1>27, dat)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_1 > 27TRUE \n    0.09984052 \n```\n:::\n\n```{.r .cell-code}\nlm(chd_2 ~ bmi_2>27, dat)$coef[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nbmi_2 > 27TRUE \n    0.09955787 \n```\n:::\n:::\n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Monterey 12.6.2\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.1.2\n\nloaded via a namespace (and not attached):\n [1] digest_0.6.31     utf8_1.2.3        R6_2.5.1          fastmap_1.1.1    \n [5] tidyselect_1.2.0  xfun_0.39         magrittr_2.0.3    glue_1.6.2       \n [9] tibble_3.2.1      knitr_1.43        pkgconfig_2.0.3   htmltools_0.5.5  \n[13] generics_0.1.3    rmarkdown_2.22    lifecycle_1.0.3   cli_3.6.1        \n[17] fansi_1.0.4       vctrs_0.6.2       compiler_4.3.0    rstudioapi_0.14  \n[21] tools_4.3.0       pillar_1.9.0      evaluate_0.21     yaml_2.3.7       \n[25] rlang_1.1.1       jsonlite_1.8.5    htmlwidgets_1.6.2\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}