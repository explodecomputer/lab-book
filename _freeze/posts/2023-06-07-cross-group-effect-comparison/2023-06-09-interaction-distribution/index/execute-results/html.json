{
  "hash": "28d2c15b686bad16e1f6a23689e65f05",
  "result": {
    "markdown": "---\ntitle: \"Differential susceptibility explained by interactors and mediators with different distributions\"\nauthor: Gibran Hemani\ndate: \"2023-06-09\"\ncategories: [interactions, multi-ancestry]\n---\n\n\n## Background\n\nWhat leads to different effect estimates in different populations? If the DAG is the same, then different distributions of mediators and interactions could explain different effects\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 100000\n\ng1 <- rbinom(n, 2, 0.3)\ng2 <- rbinom(n, 2, 0.3)\n\n# The liability for the mediator \n# Influenced by g (same effect in both populations)\n# Influenced by some other variable that gives it a different mean in the two populations\n# Now liability of mediator has different means\nml1 <- plogis(scale(g1) + rnorm(n, 2, 1))\nml2 <- plogis(scale(g2) + rnorm(n, 0, 1))\n\nhist(ml1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(ml2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generate mediators - they have different means\nm1 <- rbinom(n, 1, ml1)\nm2 <- rbinom(n, 1, ml2)\nmean(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.81663\n```\n:::\n\n```{.r .cell-code}\nmean(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.49808\n```\n:::\n:::\n\n\nDisease influenced by mediator and noise (same effects)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd1 <- rbinom(n, 1, plogis(m1 + rnorm(n)))\nd2 <- rbinom(n, 1, plogis(m2 + rnorm(n)))\n\nmean(d1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.66026\n```\n:::\n\n```{.r .cell-code}\nmean(d2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.59796\n```\n:::\n:::\n\n\nSlightly different prevalence in different populations. \n\nThe genotypic effect is now different in the two populations due to different\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglm(d1 ~ g1, family=\"binomial\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = d1 ~ g1, family = \"binomial\")\n\nCoefficients:\n(Intercept)           g1  \n     0.5736       0.1538  \n\nDegrees of Freedom: 99999 Total (i.e. Null);  99998 Residual\nNull Deviance:\t    128200 \nResidual Deviance: 128000 \tAIC: 128000\n```\n:::\n\n```{.r .cell-code}\nglm(d2 ~ g2, family=\"binomial\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:  glm(formula = d2 ~ g2, family = \"binomial\")\n\nCoefficients:\n(Intercept)           g2  \n     0.2551       0.2405  \n\nDegrees of Freedom: 99999 Total (i.e. Null);  99998 Residual\nNull Deviance:\t    134800 \nResidual Deviance: 134200 \tAIC: 134200\n```\n:::\n:::\n\n\n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Monterey 12.6.2\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nloaded via a namespace (and not attached):\n [1] htmlwidgets_1.6.2 compiler_4.3.0    fastmap_1.1.1     cli_3.6.1        \n [5] tools_4.3.0       htmltools_0.5.5   rstudioapi_0.14   yaml_2.3.7       \n [9] rmarkdown_2.22    knitr_1.43        xfun_0.39         digest_0.6.31    \n[13] jsonlite_1.8.5    rlang_1.1.1       evaluate_0.21    \n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}