{
  "hash": "dde6c31bcc077d555ef8e12e5a4ce27b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Parametric mean differences\"\nauthor: Gibran Hemani\ndate: \"2024-09-20\"\ncategories: []\n---\n\n\n## Background\n\nTesting if the mean selection coefficient amongst SNPs is larger than expected, given a background null distribution. How do we get a beta, standard error and p-value for the mean difference?\n\nGenerate data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nnull_draws <- rnorm(10000, mean=3, sd=8)\ntrue_value <- 12\nhist(null_draws, breaks=100)\nabline(v=true_value, col=\"red\", lwd=5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nEmpirical p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\nempirical_p <- sum(true_value < null_draws) / length(null_draws)\nempirical_p\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1333\n```\n\n\n:::\n:::\n\n\nParametric p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_mean <- mean(null_draws)\nnull_sd <- sd(null_draws)\nparametric_p <- 1 - pnorm(true_value, mean=null_mean, sd=null_sd)\nparametric_p\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1319797\n```\n\n\n:::\n:::\n\n\nbeta and standard error\n\n\n::: {.cell}\n\n```{.r .cell-code}\nb <- true_value - null_mean\nz <- qnorm(parametric_p, lower.tail=FALSE)\nse <- b/z\n\ntibble(b=b, se=se, parpval=parametric_p, emp_pval=empirical_p)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 4\n      b    se parpval emp_pval\n  <dbl> <dbl>   <dbl>    <dbl>\n1  8.94  8.00   0.132    0.133\n```\n\n\n:::\n:::\n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.1.4\n\nloaded via a namespace (and not attached):\n [1] digest_0.6.35     utf8_1.2.4        R6_2.5.1          fastmap_1.2.0    \n [5] tidyselect_1.2.1  xfun_0.44         magrittr_2.0.3    glue_1.7.0       \n [9] tibble_3.2.1      knitr_1.47        pkgconfig_2.0.3   htmltools_0.5.8.1\n[13] rmarkdown_2.27    generics_0.1.3    lifecycle_1.0.4   cli_3.6.2        \n[17] fansi_1.0.6       vctrs_0.6.5       compiler_4.4.1    tools_4.4.1      \n[21] pillar_1.9.0      evaluate_0.23     yaml_2.3.8        rlang_1.1.3      \n[25] jsonlite_1.8.8    htmlwidgets_1.6.4\n```\n\n\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}