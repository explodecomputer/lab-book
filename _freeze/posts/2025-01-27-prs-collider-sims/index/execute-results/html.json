{
  "hash": "78282a6bc6909b1a75c65aed0e42090c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"2025-01-27-prs-collider-sims\"\nauthor: Gibran Hemani\ndate: \"2025-03-20\"\ncategories: []\n---\n\n\n## Background\n\nObserved that GIANT BMI PRS associated with BMI in UKB with b=1.1 and in colorectal cancer cases with b=0.7. Can this be induced just from non-confounded collider bias of the variants becoming correlated withing the sample:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\nn <- 1000000\n\n\n# 1. simulate population with 10 snps, and the snps have betas on BMI\n# 2. BMI has an influence on X incidence\n# 3. U has an influence on X incidence and X progression\n\n\n\nG <- sapply(1:10, function(i) rbinom(n, 2, 0.3))\ndim(G)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1000000      10\n```\n\n\n:::\n\n```{.r .cell-code}\nb_g_bmi <- rnorm(10, 0, 0.1)\n\nbmi <- G %*% b_g_bmi + rnorm(n, 0, 1)\nu <- rnorm(n)\nb_u_x <- 0.5\nX <- rbinom(n, 1, plogis(-2 + 0.2 * bmi + b_u_x * u))\n\ntable(X)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nX\n     0      1 \n870122 129878 \n```\n\n\n:::\n\n```{.r .cell-code}\nb_u_p <- 0.5\nP <- u * b_u_p + rnorm(n)\n\n\nlibrary(simulateGP)\n\nbhat_controls <- gwas(bmi[X == 0], G[X == 0, ])\nsummary(lm(bhat_controls$bhat ~ b_g_bmi))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = bhat_controls$bhat ~ b_g_bmi)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-0.0026202 -0.0011998  0.0003991  0.0011478  0.0019200 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.0005517  0.0005388  -1.024    0.336    \nb_g_bmi      0.9933208  0.0059206 167.774 1.78e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.001701 on 8 degrees of freedom\nMultiple R-squared:  0.9997,\tAdjusted R-squared:  0.9997 \nF-statistic: 2.815e+04 on 1 and 8 DF,  p-value: 1.782e-15\n```\n\n\n:::\n\n```{.r .cell-code}\nbhat_cases <- gwas(bmi[X == 1], G[X == 1, ])\nsummary(lm(bhat_cases$bhat ~ b_g_bmi))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = bhat_cases$bhat ~ b_g_bmi)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.006455 -0.003318  0.001232  0.002730  0.005289 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.000363   0.001386  -0.262      0.8    \nb_g_bmi      0.992180   0.015227  65.158 3.42e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.004376 on 8 degrees of freedom\nMultiple R-squared:  0.9981,\tAdjusted R-squared:  0.9979 \nF-statistic:  4246 on 1 and 8 DF,  p-value: 3.424e-12\n```\n\n\n:::\n\n```{.r .cell-code}\ncor_controls <- cor(G[X == 0, ])\ncor_all <- cor(G)\ncor_cases <- cor(G[X == 1,])\n\nmean(cor_controls[lower.tri(cor_controls)]^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.069945e-06\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(cor_cases[lower.tri(cor_controls)]^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.845512e-06\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(cor_all[lower.tri(cor_controls)]^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.701122e-07\n```\n\n\n:::\n\n```{.r .cell-code}\nmean(cor(G[]))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1000345\n```\n\n\n:::\n\n```{.r .cell-code}\na <- rnorm(1000, mean=0)\npchisq(sum(a^2), 1000, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1716113\n```\n\n\n:::\n\n```{.r .cell-code}\na <- rnorm(1000, mean=0.6)\npchisq(sum(a^2), 1000, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.381745e-17\n```\n\n\n:::\n\n```{.r .cell-code}\na <- rnorm(1000, sd=0.1)\npchisq(sum(a^2), 1000, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n```\n\n\n:::\n:::\n\n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.3 (2025-02-28)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] simulateGP_0.1.3 dplyr_1.1.4     \n\nloaded via a namespace (and not attached):\n [1] digest_0.6.37     utf8_1.2.4        R6_2.5.1          fastmap_1.2.0    \n [5] tidyselect_1.2.1  xfun_0.48         magrittr_2.0.3    glue_1.8.0       \n [9] tibble_3.2.1      knitr_1.48        pkgconfig_2.0.3   htmltools_0.5.8.1\n[13] rmarkdown_2.27    generics_0.1.3    lifecycle_1.0.4   cli_3.6.3        \n[17] fansi_1.0.6       vctrs_0.6.5       compiler_4.4.3    tools_4.4.3      \n[21] pillar_1.9.0      evaluate_1.0.1    yaml_2.3.10       rlang_1.1.4      \n[25] jsonlite_1.8.9    htmlwidgets_1.6.4\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}