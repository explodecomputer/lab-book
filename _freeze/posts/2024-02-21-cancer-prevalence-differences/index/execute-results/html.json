{
  "hash": "5121d1b8ced5fb2bbabb0e23a7bacf4f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Differences in cancer prevalence and heritability\"\nauthor: Gibran Hemani\ndate: \"2024-02-21\"\ncategories: []\n---\n\n\n## Background\n\n[Richard Peto points out, and later George Davey Smith](https://link.springer.com/article/10.1007/s10654-023-01090-5#Sec3), that cancer prevalence is very different across geographical regions and across time periods within geographical regions. Such systematic differences are too rapid to be explained by genetic factors, and too structured to be explained by chance. When comparing the rates of cancer between the highest 20% and lowest 20% prevalence, they suggest that ~80% of cancer is due to modifiable risk factors. Similar rates for mortality differences, meaning that it's plausible that this isn't due to differential rates of cancer detection.\n\nHow does this square with heritability? It implies that 80% of the variance in cancer is due to a set of modifiable factors. But if h2 is higher than 20% then is this possible?\n\nConsider smoking and lung cancer. If smoking is partially genetic and partially environmental, what happens in this high vs low prevalence calculation?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n:::\n\n\nPositive control, lets make it so that 80% of the trait is due to environment and 20% random chance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 10000\n\ndat <- bind_rows(\n    tibble(\n        envir = rbinom(n, 1, 0) * 10,\n        cancer = rbinom(n, 1, plogis(-1.9 + envir)),\n        cat=\"low\"\n    ),\n    tibble(\n        envir = rbinom(n, 1, 0.8) * 10,\n        cancer = rbinom(n, 1, plogis(-1.9 + envir)),\n        cat=\"high\"\n    )\n) \n\ncor(dat$envir[dat$cat==\"high\"], dat$cancer[dat$cat==\"high\"])^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8446091\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(dat$envir, dat$cancer)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7238202\n```\n\n\n:::\n\n```{.r .cell-code}\ndat %>%\n    group_by(cat) %>%\n    summarise(prev_cancer = sum(cancer) / n(), mean_env = mean(envir))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  cat   prev_cancer mean_env\n  <chr>       <dbl>    <dbl>\n1 high        0.824     7.98\n2 low         0.133     0   \n```\n\n\n:::\n:::\n\n\nNow introduce genetic variance\n\nThere is a heritability of 50% which is independent of environmental effect\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- bind_rows(\n    tibble(\n        envir = rbinom(n, 1, 0) * 10,\n        g = rnorm(n),\n        cancer = rbinom(n, 1, plogis(-1.9 + envir + g*10)),\n        cat=\"low\"\n    ),\n    tibble(\n        envir = rbinom(n, 1, 0.8) * 10,\n        g = rnorm(n),\n        cancer = rbinom(n, 1, plogis(-1.9 + envir + g*10)),\n        cat=\"high\"\n    )\n) \ncor(dat$g[dat$cat==\"high\"], dat$cancer[dat$cat==\"high\"])^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4609893\n```\n\n\n:::\n\n```{.r .cell-code}\ndat %>%\n    group_by(cat) %>%\n    summarise(prev_cancer = sum(cancer) / n(), mean_env = mean(envir))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  cat   prev_cancer mean_env\n  <chr>       <dbl>    <dbl>\n1 high        0.72      8.04\n2 low         0.429     0   \n```\n\n\n:::\n:::\n\n\nThat raises the prevalence in the low group. Now lets make the genetic factor mediated through behaviour\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- bind_rows(\n    tibble(\n        g = rnorm(n),\n        e = rnorm(n, sd=1),\n        envir = rbinom(n, 1, plogis(g + e)) * 10,\n        cancer = rbinom(n, 1, plogis(-1.9 + envir)),\n        cat=\"low\"\n    ),\n    tibble(\n        g = rnorm(n),\n        e = rnorm(n, sd=10),\n        envir = rbinom(n, 1, plogis(g + e)) * 10,\n        cancer = rbinom(n, 1, plogis(-1.9 + envir)),\n        cat=\"high\"\n    )\n) \ncor(dat$g[dat$cat==\"high\"], dat$cancer[dat$cat==\"high\"])^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.003601906\n```\n\n\n:::\n\n```{.r .cell-code}\ndat %>%\n    group_by(cat) %>%\n    summarise(prev_cancer = sum(cancer) / n(), mean_env = mean(envir))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n  cat   prev_cancer mean_env\n  <chr>       <dbl>    <dbl>\n1 high        0.570     5.08\n2 low         0.575     5.07\n```\n\n\n:::\n:::\n\n\nI think you need a G x E interaction. You might have a high liability to smoke but the availability of cigarettes is very low, so that genetic variance cannot manifest. How does that appear as a statistical model? It will be the genetic risk on outcome + environmental risk on outcome, multiplied by accessibility to the outcome\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- bind_rows(\n    tibble(\n        g = rbeta(n, 3, 1),\n        accessibility = rbinom(n, 1, 0.001),\n        envir = rbinom(n, 1, g * accessibility),\n        cancer = rbinom(n, 1, plogis(-1.9 + envir * 10)),\n        cat=\"low\"\n    ),\n    tibble(\n        g = rbeta(n, 3, 1),\n        accessibility = rbinom(n, 1, 0.999),\n        envir = rbinom(n, 1, g * accessibility),\n        cancer = rbinom(n, 1, plogis(-1.9 + envir * 10)),\n        cat=\"high\"\n    )\n) \ncor(dat$g[dat$cat==\"high\"], dat$cancer[dat$cat==\"high\"])^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1650788\n```\n\n\n:::\n\n```{.r .cell-code}\ncor(dat$g[dat$cat==\"low\"], dat$cancer[dat$cat==\"low\"])^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.372442e-05\n```\n\n\n:::\n\n```{.r .cell-code}\ndat %>%\n    group_by(cat) %>%\n    summarise(prev_cancer = sum(cancer) / n(), mean_env = mean(envir), mean_acc=mean(accessibility), mean_env_p = mean(plogis(envir)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  cat   prev_cancer mean_env mean_acc mean_env_p\n  <chr>       <dbl>    <dbl>    <dbl>      <dbl>\n1 high        0.774   0.741    0.999       0.671\n2 low         0.129   0.0008   0.0011      0.500\n```\n\n\n:::\n:::\n\n\nBut here the heritability is limited to the non-genetic variance.\n\n## Summary\n\nNot clear what model would allow heritability to be greater than the variance explained by environmental factors. \n\n\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.3.2 (2023-10-31)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Ventura 13.6\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8\n\ntime zone: Europe/London\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] dplyr_1.1.4\n\nloaded via a namespace (and not attached):\n [1] digest_0.6.33     utf8_1.2.4        R6_2.5.1          fastmap_1.1.1    \n [5] tidyselect_1.2.0  xfun_0.41         magrittr_2.0.3    glue_1.6.2       \n [9] tibble_3.2.1      knitr_1.45        pkgconfig_2.0.3   htmltools_0.5.7  \n[13] rmarkdown_2.25    generics_0.1.3    lifecycle_1.0.4   cli_3.6.1        \n[17] fansi_1.0.5       vctrs_0.6.4       compiler_4.3.2    tools_4.3.2      \n[21] pillar_1.9.0      evaluate_0.23     yaml_2.3.7        rlang_1.1.2      \n[25] jsonlite_1.8.7    htmlwidgets_1.6.3\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}